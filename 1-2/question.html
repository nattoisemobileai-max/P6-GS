<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âπ≥ÂÆâÊòØÁ¶èÔºöÂÆâÂÖ®Ê∏¨Ë©¶ÊåëÊà∞</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --duo-green: #58cc02;
            --duo-dark-green: #46a302;
            --duo-blue: #1cb0f6;
            --duo-red: #ff4b4b;
            --duo-gray: #afafaf;
            --duo-light-gray: #e5e5e5;
            --text-main: #4b4b4b;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            margin: 0;
            background-color: #fff;
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* È†ÇÈÉ®ÈÄ≤Â∫¶Ê¢ù */
        .nav-bar {
            width: 100%;
            max-width: 600px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-sizing: border-box;
        }

        .progress-rail {
            flex-grow: 1;
            height: 16px;
            background-color: var(--duo-light-gray);
            border-radius: 10px;
        }

        .progress-fill {
            width: 0%;
            height: 100%;
            background-color: var(--duo-green);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        /* ‰∏ªÈ°åÂÖßÂÆπ */
        .content {
            width: 90%;
            max-width: 600px;
            margin-top: 40px;
            flex-grow: 1;
        }

        .speech-bubble {
            border: 2px solid var(--duo-light-gray);
            border-radius: 15px;
            padding: 20px;
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 30px;
            position: relative;
        }

        .options-list {
            display: grid;
            gap: 12px;
        }

        .option-item {
            border: 2px solid var(--duo-light-gray);
            border-bottom-width: 4px;
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 1.1em;
            font-weight: 500;
            cursor: pointer;
            transition: 0.1s;
            user-select: none;
        }

        .option-item:hover { 
            background-color: #f7f7f7; 
            transform: translateY(-1px);
        }
        
        .option-item.active {
            border-color: var(--duo-blue);
            background-color: #ddf4ff;
            color: var(--duo-blue);
            transform: translateY(-1px);
        }

        /* Â∫ïÈÉ®Êìç‰ΩúÊ¨Ñ */
        .footer {
            width: 100%;
            padding: 20px;
            display: flex;
            justify-content: center;
            border-top: 2px solid var(--duo-light-gray);
            background: #fff;
        }

        .btn-action {
            width: 100%;
            max-width: 600px;
            padding: 16px;
            border-radius: 15px;
            font-size: 1.1em;
            font-weight: 900;
            cursor: pointer;
            border: none;
            background-color: var(--duo-green);
            color: white;
            box-shadow: 0 5px 0 var(--duo-dark-green);
            transition: all 0.2s;
        }

        .btn-action:hover {
            background-color: #4bc000;
        }

        .btn-action:active {
            transform: translateY(2px);
            box-shadow: 0 3px 0 var(--duo-dark-green);
        }

        .btn-action:disabled {
            background-color: var(--duo-light-gray);
            color: var(--duo-gray);
            box-shadow: 0 5px 0 #ccc;
            cursor: not-allowed;
        }

        /* ÂèçÈ•ãÊªëÂãïÂ±§ */
        #feedback-tray {
            position: fixed;
            bottom: -350px;
            left: 0;
            width: 100%;
            padding: 30px;
            box-sizing: border-box;
            transition: bottom 0.3s ease;
            z-index: 100;
        }

        .tray-correct { 
            background-color: #d7ffb8; 
            color: #58a700; 
            border-top: 3px solid #58a700;
        }
        
        .tray-wrong { 
            background-color: #ffdfe0; 
            color: #ea2b2b; 
            border-top: 3px solid #ea2b2b;
        }

        .btn-next {
            background-color: currentColor;
            filter: brightness(0.8);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 12px;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-next:hover {
            filter: brightness(1);
            transform: scale(1.05);
        }

        #final-screen { 
            display: none; 
            text-align: center; 
            margin-top: 100px;
            padding: 20px;
        }
        
        .question-counter {
            color: var(--duo-gray);
            font-size: 0.9em;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <div class="nav-bar">
        <span style="color:var(--duo-gray); font-size: 24px; cursor: pointer;" onclick="location.reload()">‚úï</span>
        <div class="progress-rail"><div class="progress-fill" id="pb"></div></div>
    </div>

    <div class="content" id="quiz-ui">
        <div class="question-counter" id="counter">Á¨¨ <span id="current-q">1</span> È°åÔºåÂÖ± <span id="total-q">?</span> È°å</div>
        <div class="speech-bubble" id="q-text">ü¶â Ê≠£Âú®ÁÇ∫‰Ω†Ê∫ñÂÇôÈ°åÁõÆ...</div>
        <div class="options-list" id="opt-list"></div>
    </div>

    <div id="final-screen">
        <h1 style="font-size: 4em;">üèÜ</h1>
        <h2 id="final-msg">‰Ω†ÂÆåÊàê‰∫ÜÊâÄÊúâÊåëÊà∞ÔºÅ</h2>
        <p id="final-score" style="font-size: 1.5em; font-weight: 700; color: var(--duo-blue);"></p>
        <button class="btn-action" onclick="location.reload()" style="margin-top: 20px;">ÈáçÊñ∞ÈñãÂßã</button>
    </div>

    <div class="footer" id="footer-bar">
        <button class="btn-action" id="check-btn" disabled onclick="handleCheck()">Ê™¢Êü•Á≠îÊ°à</button>
    </div>

    <div id="feedback-tray">
        <div style="max-width: 600px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h2 id="tray-title" style="margin:0">ÂæàÂ•ΩÔºÅ</h2>
                <p id="tray-desc" style="margin: 5px 0 0; font-weight: 500;"></p>
            </div>
            <button class="btn-next" onclick="loadNext()">ÁπºÁ∫å</button>
        </div>
    </div>

<script>
    // ÈÅäÊà≤ÁãÄÊÖãËÆäÊï∏
    let currentQuestionIndex = 0;
    let score = 0;
    let selectedOption = null;
    let quizData = null;
    let canSelect = true;

    // ËºâÂÖ•Ê∏¨È©óÊï∏Êìö
    async function loadQuizData() {
        try {
            const response = await fetch('QuizData.json');
            if (!response.ok) {
                throw new Error('ÁÑ°Ê≥ïËºâÂÖ•È°åÁõÆÊï∏Êìö');
            }
            quizData = await response.json();
            initializeQuiz();
        } catch (error) {
            console.error('ËºâÂÖ•Êï∏ÊìöÂ§±Êïó:', error);
            document.getElementById('q-text').innerText = '‚ùå ÁÑ°Ê≥ïËºâÂÖ•È°åÁõÆÊï∏ÊìöÔºåË´ãÊ™¢Êü• QuizData.json Ê™îÊ°àÊòØÂê¶Â≠òÂú®';
        }
    }

    // ÂàùÂßãÂåñÊ∏¨È©ó
    function initializeQuiz() {
        if (!quizData || !quizData.questions || quizData.questions.length === 0) {
            document.getElementById('q-text').innerText = '‚ùå Ê≤íÊúâÂèØÁî®ÁöÑÈ°åÁõÆÊï∏Êìö';
            return;
        }
        
        // Êõ¥Êñ∞Á∏ΩÈ°åÊï∏È°ØÁ§∫
        document.getElementById('total-q').textContent = quizData.questions.length;
        
        // ËºâÂÖ•Á¨¨‰∏ÄÈ°å
        loadQuestion();
    }

    // ËºâÂÖ•È°åÁõÆ
    function loadQuestion() {
        if (!quizData) return;
        
        const question = quizData.questions[currentQuestionIndex];
        
        // Êõ¥Êñ∞È°åÁõÆÁ∑®Ëôü
        document.getElementById('current-q').textContent = currentQuestionIndex + 1;
        
        // Êõ¥Êñ∞ÈÄ≤Â∫¶Ê¢ù
        const progress = ((currentQuestionIndex) / quizData.questions.length) * 100;
        document.getElementById('pb').style.width = `${progress}%`;
        
        // È°ØÁ§∫È°åÁõÆ
        document.getElementById('q-text').textContent = question.q;
        
        // Ê∏ÖÁ©∫‰∏¶ÈáçÂª∫ÈÅ∏È†Ö
        const optionsList = document.getElementById('opt-list');
        optionsList.innerHTML = '';
        
        // ÂâµÂª∫ÈÅ∏È†Ö
        question.o.forEach((optionText, index) => {
            const optionDiv = document.createElement('div');
            optionDiv.className = 'option-item';
            optionDiv.textContent = optionText;
            optionDiv.dataset.index = index;
            
            // Ê∑ªÂä†ÈªûÊìä‰∫ã‰ª∂Áõ£ËÅΩÂô®
            optionDiv.addEventListener('click', () => selectOption(optionDiv, index));
            
            optionsList.appendChild(optionDiv);
        });
        
        // ÈáçÁΩÆÁãÄÊÖã
        selectedOption = null;
        canSelect = true;
        document.getElementById('check-btn').disabled = true;
        
        // Èö±ËóèÂèçÈ•ãÈù¢Êùø
        document.getElementById('feedback-tray').style.bottom = '-350px';
    }

    // ÈÅ∏ÊìáÈÅ∏È†Ö
    function selectOption(optionElement, optionIndex) {
        if (!canSelect) return; // Â¶ÇÊûúÂ∑≤Á∂ìÊ™¢Êü•ÈÅéÁ≠îÊ°àÔºå‰∏çËÉΩÂÜçÊ¨°ÈÅ∏Êìá
        
        // ÁßªÈô§ÊâÄÊúâÈÅ∏È†ÖÁöÑ active È°û
        document.querySelectorAll('.option-item').forEach(item => {
            item.classList.remove('active');
        });
        
        // Ê∑ªÂä†Áï∂ÂâçÈÅ∏È†ÖÁöÑ active È°û
        optionElement.classList.add('active');
        
        // ‰øùÂ≠òÈÅ∏Êìá
        selectedOption = optionIndex;
        
        // ÂïüÁî®Ê™¢Êü•Á≠îÊ°àÊåâÈàï
        document.getElementById('check-btn').disabled = false;
    }

    // Ê™¢Êü•Á≠îÊ°à
    function handleCheck() {
        if (selectedOption === null || !canSelect || !quizData) return;
        
        const question = quizData.questions[currentQuestionIndex];
        const feedbackTray = document.getElementById('feedback-tray');
        const trayTitle = document.getElementById('tray-title');
        const trayDesc = document.getElementById('tray-desc');
        
        // Á¶ÅÊ≠¢ÂÜçÊ¨°ÈÅ∏Êìá
        canSelect = false;
        
        // È´ò‰∫ÆÈ°ØÁ§∫Ê≠£Á¢∫ÂíåÈåØË™§Á≠îÊ°à
        const allOptions = document.querySelectorAll('.option-item');
        allOptions.forEach((option, index) => {
            if (index === question.a) {
                option.classList.add('correct');
                option.style.borderColor = '#58cc02';
                option.style.backgroundColor = '#e8ffd8';
            } else if (index === selectedOption && selectedOption !== question.a) {
                option.classList.add('wrong');
                option.style.borderColor = '#ff4b4b';
                option.style.backgroundColor = '#ffeaea';
            }
        });
        
        // È°ØÁ§∫ÂèçÈ•ã
        if (selectedOption === question.a) {
            score++;
            feedbackTray.className = 'tray-correct';
            trayTitle.textContent = 'Á≠îÂ∞ç‰∫ÜÔºÅ';
        } else {
            feedbackTray.className = 'tray-wrong';
            trayTitle.textContent = 'ÂÜçÊé•ÂÜçÂé≤ÔºÅ';
        }
        
        trayDesc.textContent = question.d;
        feedbackTray.style.bottom = '0';
        
        // Á¶ÅÁî®Ê™¢Êü•ÊåâÈàï
        document.getElementById('check-btn').disabled = true;
    }

    // ËºâÂÖ•‰∏ã‰∏ÄÈ°å
    function loadNext() {
        currentQuestionIndex++;
        
        if (currentQuestionIndex < quizData.questions.length) {
            loadQuestion();
        } else {
            // È°ØÁ§∫ÊúÄÁµÇÁµêÊûú
            showFinalResults();
        }
    }

    // È°ØÁ§∫ÊúÄÁµÇÁµêÊûú
    function showFinalResults() {
        document.getElementById('quiz-ui').style.display = 'none';
        document.getElementById('footer-bar').style.display = 'none';
        document.getElementById('pb').style.width = '100%';
        document.getElementById('final-screen').style.display = 'block';
        
        const scorePercent = Math.round((score / quizData.questions.length) * 100);
        let message = '‰Ω†ÂÆåÊàê‰∫ÜÊâÄÊúâÊåëÊà∞ÔºÅ';
        
        if (scorePercent === 100) {
            message = 'üéâ ÂÆåÁæéÔºÅ‰Ω†ÊòØÂÆâÂÖ®Áü•Ë≠òÈÅî‰∫∫ÔºÅ';
        } else if (scorePercent >= 80) {
            message = 'üëç ÂÑ™ÁßÄÔºÅ‰Ω†Â∞çÂÆâÂÖ®Áü•Ë≠òÊéåÊè°ÂæóÂæàÂ•ΩÔºÅ';
        } else if (scorePercent >= 60) {
            message = 'üëå ‰∏çÈåØÔºÅÁπºÁ∫åÂ≠∏ÁøíÊúÉÊõ¥ÂÆâÂÖ®ÔºÅ';
        } else {
            message = 'üí™ ÂÜçË§áÁøí‰∏Ä‰∏ãÊúÉÊõ¥ÂÆâÂÖ®ÂñîÔºÅ';
        }
        
        document.getElementById('final-msg').textContent = message;
        document.getElementById('final-score').textContent = `ÂæóÂàÜÔºö${score} / ${quizData.questions.length} (${scorePercent}%)`;
    }

    // È†ÅÈù¢ËºâÂÖ•ÊôÇÈñãÂßã
    document.addEventListener('DOMContentLoaded', loadQuizData);
    
    // Ê∑ªÂä†ÈçµÁõ§Âø´Êç∑ÈçµÊîØÊè¥
    document.addEventListener('keydown', function(event) {
        if (event.key >= '1' && event.key <= '4' && canSelect) {
            const optionIndex = parseInt(event.key) - 1;
            const options = document.querySelectorAll('.option-item');
            if (optionIndex < options.length) {
                selectOption(options[optionIndex], optionIndex);
            }
        } else if (event.key === 'Enter' && !document.getElementById('check-btn').disabled) {
            handleCheck();
        }
    });
</script>
</body>
</html>
